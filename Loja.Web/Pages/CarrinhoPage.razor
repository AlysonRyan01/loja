@page "/carrinho"
@using Loja.Core.Models
@inherits CarrinhoComponent

<div class="carrinho">
    @if (IsBusy)
    {
        <MudProgressCircular Color="Color.Info" Indeterminate="true" />
    }
    else
    {
        @if (!CarrinhoItens.Any())
        {
            <MudPaper Style="width: 30vw; border-radius: 20px">
                <h2 style="justify-self: center; padding: 20px; color: gray;">CARRINHO VAZIO</h2>
                <img class="carrinho-vazio" src="images/5073073-nenhum-item-no-carrinho-de-compras-.jpg" alt="nenhum item encontrado no carrinho"/>
            </MudPaper>
        }
        else
        {
            <div style="display: flex; flex-direction: column">
            
                @foreach (var Itens in CarrinhoItens)
                {
                    <MudPaper Style="width: 40vw; margin-right: 5vw; margin-bottom: 5vh;">
                        <h4 style="padding: 1vw; text-align: start; justify-content: start">@Itens.Produto.Descricao</h4>
                        <hr class="custom-hr">
                        <MudCarousel Style="height: 25vh;" ShowArrows="true" EnableSwipeGesture="true" TData="Imagem" Indicators="true">
                            @foreach (var imagem in Itens.Produto.Imagens)
                            {
                                var imagemUrl = $"{WebConfiguration.BackendUrl}{imagem.Url}";
                                <MudCarouselItem>
                                    <img src="@imagemUrl" alt="sla" width="30%"/>
                                </MudCarouselItem>
                            }
                        </MudCarousel>
                        <hr class="custom-hr">
                        <MudCardContent  Style="text-align: start;">
                            <p style="text-decoration: line-through; color: gray;">De R$ @Itens.Produto.Preco.ToString("F2")</p>
                            <p style="font-size: 1.2em; font-weight: bold; color: black;">Por R$ @Itens.Produto.Preco.ToString("F2")</p>

                            <MudButton OnClick="() => ExcluirDoCarrinho(Itens.Id)" Color="Color.Primary" Variant="Variant.Filled" Style="margin-top: 10px; color: white">
                                Excluir do carrinho
                            </MudButton>
                        </MudCardContent>
                    </MudPaper>
                }
            </div>
            <div style="width: 25vw;">
                <MudPaper Style="display: flex; flex-direction: column; flex-wrap: wrap; overflow: auto">
                    <h3 style="padding: 20px">Resumo da compra</h3>
                    <hr class="custom-hr">
                    <div style="display: flex; justify-content: space-between; margin-left: 20px; margin-right: 20px; margin-top: 10px;">
                        <p>Produto(s): @QuantidadeProdutos</p>
                        <p>R$ @Carrinho.ValorTotal.ToString("F2")</p>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-left: 20px; margin-right: 20px; margin-top: 10px;">
                        <p>Frete(s):</p>
                        <p>Grátis</p>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 20px;">
                        <h2>Total:</h2>
                        <h2>R$ @Carrinho.ValorTotal.ToString("F2")</h2>
                    </div>
                    <MudButton Color="Color.Primary" Variant="Variant.Filled" Style="margin-top: 10px; margin-bottom: 20px; color: white; width: 90%; align-self: center">
                        Continuar a compra
                    </MudButton>
                </MudPaper>
            </div>
        }
    }
</div>
<div style="width: 100%; height: 600px; background-color: #E0E0E0; display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <h2>Recomendações para você</h2>
    <MudCarousel TData="Produto" Style="width: 100%; height: 500px" ShowArrows="true" EnableSwipeGesture="true" Indicators="true" AutoPlay="false" ActiveIndex="0">
        @foreach (var grupo in Produtos.Chunk(3))
        {
            <MudCarouselItem style="display: flex; justify-content: center; align-self: center; gap: 16px;">
                @foreach (var itens in grupo)
                {
                    <MudPaper Style="width: 40vw; min-height: 350px; margin-right: 5vw; margin-bottom: 5vh;">
                        <h4 style="padding: 1vw; text-align: start; justify-content: start">@itens.Descricao</h4>
                        <hr class="custom-hr">
                        <MudCarousel Style="height: 25vh;" ShowArrows="true" EnableSwipeGesture="true" TData="Imagem" Indicators="true">
                            @foreach (var imagem in itens.Imagens)
                            {
                                var imagemUrl = $"{WebConfiguration.BackendUrl}{imagem.Url}";
                                <MudCarouselItem>
                                    <img src="@imagemUrl" alt="sla" width="30%"/>
                                </MudCarouselItem>
                            }
                        </MudCarousel>
                        <hr class="custom-hr">
                        <MudCardContent Style="text-align: start;">
                            <p style="text-decoration: line-through; color: gray;">De R$ @itens.Preco.ToString("F2")</p>
                            <p style="font-size: 1.2em; font-weight: bold; color: black;">Por R$ @itens.Preco.ToString("F2")</p>
                        </MudCardContent>
                    </MudPaper>
                }
            </MudCarouselItem>
        }
    </MudCarousel>
</div>
